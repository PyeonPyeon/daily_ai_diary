<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri = "http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri = "http://java.sun.com/jsp/jstl/fmt" %>

<c:set var ="cpath" value ="${pageContext.request.contextPath}"/> 
<c:set var ="awsPath" value ="https://daydayday.s3.ap-northeast-2.amazonaws.com/day"/>

<!DOCTYPE HTML>
<!--
   Read Only by HTML5 UP
   html5up.net | @ajlkn
   Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
   <head>
      <title>Read Only by HTML5 UP</title>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
      <link rel="stylesheet" href="${cpath}/resources/css/main.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
     <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
        <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>   
   
   
    <style type="text/css">
  
  /* ì‚¬ìš©ì ì§€ì • ìƒ‰ */
     :root {
        --sidebar-color: ${myblog.blog_sidebar};
    } 
input[type="text"] {
    height: 2.75em;
    max-width: 40%;
    margin: auto; 
}


  </style>
   </head>
   <body class="is-preload" style="background-color:${myblog.blog_main};">




   <!-- ì‚¬ì´ë“œë°” -->
         <section id="header" style="background-color:${myblog.blog_sidebar};">
            <header>
               <span class="image avatar">
               <div class="profileDiv"><img id="profileImg" class="img-circle" src="${myblog.blog_profile}" alt="" /></div>

               </span>
               <h1 id="logo"><a href="#">${mvo.user_nick}</a></h1>
                     <p>${myblog.blog_greetings }</p>
            </header>
            <nav id="nav">
               <ul>
                  <li><a href="#one" class="section-link active" data-section="diary">ë‹¤ì´ì–´ë¦¬</a></li>
                  <li><a href="#two" class="section-link" data-section="guestBook">ë°©ëª…ë¡</a></li>
                  <!--  <li><a href="#three" class="section-link" data-section="tempStorage">ì„ì‹œë³´ê´€í•¨</a></li> -->
                  <!--<c:if test="${not empty mvo}"> </c:if> -->
                     <li><a href="#four" class="section-link" data-section="blogSetting">ë¸”ë¡œê·¸ ê´€ë¦¬</a></li>
                  
               </ul>
            </nav>
            
            
            <footer>
              <ul class="icons">
                  <li><span class="label">Copyright â“’ 2023 D.A.Y Rights Reserved.</span></li>
               </ul>
            </footer>
         </section>


      <!-- Wrapper -->
         <div id="wrapper" style="background-color:${myblog.blog_main};">


            <!-- Main -->
               
          <!-- header ì´ë¯¸ì§€ -->
           <div id="main-head">
		        <div class="image main" data-position="center" id="imageContainer">
		            <img src="${myblog.blog_header}" alt="" id="headerImage" />
		            <p class="imgText" id="imageText">${myblog.blog_title}</p>
		        </div>
		    </div>
      
      
      
            <div id="main">
                          <!-- ë‹¤ì´ì–´ë¦¬ -->
                   <div class="container" id="diary">
                     <h3>DIARY</h3>
                       <div class="btnClass">
                    <button class="group-3" id="goEdit" data-toggle="modal" type="button" onclick="location.href='${cpath}/edit/in'" >
                        <div class="group-4">
                          <img class="img" src="${awsPath}/images/goWrite.png" />
                          <div class="text-wrapper-4">ê¸€ì‘ì„±</div>
                        </div>
                    </button>                  
                    <button class="group-3" id="goEdit" data-toggle="modal" data-target="#makeDiary">
                        <div class="group-4">
                          <img class="img" src="${awsPath}/images/diary_add.png" />
                          <div class="text-wrapper-4">ë§Œë“¤ê¸°</div>
                        </div>
                    </button>                  
                       </div>
                       
 			<div id="diaryContainer">
                  <ul class="thumblist">
                     <c:forEach var="vo" items="${diary}">
                        <li class="item">
                           <div class="itemCon">
                              <div class="area_thumb_with_dropdown">
                                 <div class="area_thumb">
                                    <a class="section-link diaryIdx" onclick="getBoard(${vo.diary_idx});" href="#" data-section="tempStorage">
                                       <img class="thumb" src="${awsPath}/cover/${vo.diary_cover}">
                                    </a>
                                 </div>
                                 <div id="dropdown-div">
                                     <button class="dropdown-toggle morebtn" type="button" data-toggle="dropdown"><img src="${awsPath}/img/more2.png"></button>
                                    <div class="dropFrm dropdown-menu" style="min-width:0;">
                                      <a class="dropItem" href="#">ìˆ˜ì •</a>
                                      <a class="dropItem" href="${cpath}/myblog/diaryDelete?idx=${vo.diary_idx}">ì‚­ì œ</a>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="area_text">
                              <a class="section-link diaryIdx" onclick="getBoard(${vo.diary_idx});" href="#" data-section="tempStorage"><span class="title ell">${vo.diary_name }</span></a>
                           </div>
                        </li>
                     </c:forEach>
                  </ul>
               </div>
            </div>
         </div>
         
                     <!-- ê¸€ì“°ê¸°(ë°©ëª…ë¡) ì‘ì„± í¼ -->
            <div class="modal fade" id="makeDiary">
               <div class="modal-container modal-dialog modal-dialog-centered">
                  <div class="modal-content">
                     <!-- Modal Header -->
                     <div class="modalHeader">
                        <h4 class="modal-title"></h4>
                        <button type="button" class="btn" data-dismiss="modal"><img class="closeModal" src="${awsPath}/images/close.png"></button>
                     </div>
                     <!-- Modal body -->
                     <div class="modal-body">
                     <form action="${cpath}/myblog/makediary" method="post">
                        
                           <!--  ë¡œê·¸ì¸í•œ íšŒì› ì•„ì´ë”” ì •ë³´ë„ í•¨ê»˜ ë³´ë‚´ì£¼ê¸° for íšŒì›ì œ ê²Œì‹œíŒ -->
                           <input type="hidden" name="user_id" value="${mvo.user_id}">
                           <table class="modalContent">
                                 <tr>
                                    <td colspan="5"><input type="text" name="diary_name" placeholder="ë‹¤ì´ì–´ë¦¬ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”."></td>
                                 </tr>
                                 <tr>
                                    <td><input class="coverPick" id="cover1" type="radio" name="diary_cover" value="cover1.jpg">
                                    <label for="cover1"><img class="cover" src="${awsPath}/cover/cover1.jpg"></label></td>
                                 
                                    <td><input class="coverPick" id="cover2" type="radio" name="diary_cover" value="cover2.jpg">
                                    <label for="cover2"><img class="cover" src="${awsPath}/cover/cover2.jpg"></label></td>
                                 
                                    <td><input class="coverPick" id="cover3" type="radio" name="diary_cover" value="cover3.jpg">
                                    <label for="cover3"><img class="cover" src="${awsPath}/cover/cover3.jpg"></label></td>
                                 
                                    <td><input class="coverPick" id="cover4" type="radio" name="diary_cover" value="cover4.jpg">
                                    <label for="cover4"><img class="cover" src="${awsPath}/cover/cover4.jpg"></label></td>
                                 
                                    <td><input class="coverPick" id="cover5" type="radio" name="diary_cover" value="cover5.jpg">
                                    <label for="cover5"><img class="cover" src="${awsPath}/cover/cover5.jpg"></label></td>
                                 </tr>
                                 
                           </table>
                           <div class="modalFooter">
                              <input class="btn btn-defalut" type="submit" value="í™•ì¸">
                           </div>
                        </form>
                     </div>
                  </div>
               </div>
            </div>


            <!-- ë°©ëª…ë¡ -->
		<div class="container" id="guestBook">
            <h3>ë°©ëª…ë¡ğŸ“ƒ</h3>
            <%-- <h6>${mvo.user_nick}ë‹˜ì—ê²Œ ìª½ì§€ë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆëŠ” ê³µê°„ì…ë‹ˆë‹¤. ë”°ëœ»í•œ í•œ ë§ˆë””ë¥¼ ë‚¨ê²¨ë³´ì„¸ìš”! ğŸ˜Š </h6> --%>
            <div id="visitList"></div>
         </div>



         <!-- ë‹¤ì´ì–´ë¦¬ ìƒì„¸í˜ì´ì§€ -->
		<div class="container" id="tempStorage">
			<div class="book-header">
				<p id="diaryName"></p>
				<div class="row-header">
					<p id="boardTitle"></p>
					<div class="back-btn">
						<a id="mainbtn" href="${cpath}/myblog/in" class="button">ëª©ë¡</a>
					</div>
				</div>
			</div>
			<div id="book" class="features"></div>

			<div id="pagination">
				<button class="pagebtn" onclick="changePage('prev')">
					<img id="prev-btn" src="${awsPath}/img/left-dark.png">
				</button>
				<!--   <span id="current-page">1</span> / <span id="total-pages"></span> -->
				<button class="pagebtn" onclick="changePage('next')">
					<img id="next-btn" src="${awsPath}/img/right-dark.png">
				</button>
			</div>
		</div>





		<!-- ë¸”ë¡œê·¸ ê´€ë¦¬ -->
      <div class="container" id="blogSetting">
                          <div class="formDiv">
                           <h3>ë¸”ë¡œê·¸ ê´€ë¦¬</h3>
                           <div>
                              <form action="${cpath}/myblog/blogUpdate" method="post" enctype="multipart/form-data">
                                 <!--  <div class="row gtr-uniform"> -->
                                 <input type="hidden" name="user_id" value="${mvo.user_id}">
                                    <table class="table">
                                       <tr>
                                          <th>í”„ë¡œí•„ ì‚¬ì§„</th>
                                          <td>
                                             <div class="imgDiv"><img id ="profile" class="img-circle" src="${myblog.blog_profile}"></div> <br>
                                             <div class="inputDiv">
                                                <label for="blog_profile" class="input-btn">ì‚¬ì§„ë³€ê²½</label>
                                                <input type="file" accept="image/*" id="blog_profile" name="blog_profile" onchange="readProfile(this)" style="display:none;">
                                                <label for="profileReset" class="input-btn">ì‚­ì œ</label>
                                                <input type="reset" id="profileReset" style="display:none;"/>
                                             </div>                                             
                                          </td>
                                       </tr>
                                     
                                       <tr>
                                          <th>ë¸”ë¡œê·¸ ì œëª©</th>
                                          <td><input type="text" name="blog_title" id="blog_title" value="${myblog.blog_title}"></td>
                                       </tr>
                                       <tr>
                                          <th>ì†Œê°œê¸€</th>
                                          <td><input type="text" name="blog_greetings" id="blog_intro" value="${myblog.blog_greetings}"></td>
                                       </tr>
                                       <tr>
                                          <th>í—¤ë”</th>
                                          <td>
                                             <div class="imgDiv"><img id ="blogHeader" src="${myblog.blog_header}"> <br>
                                             <div class="headerDiv">
                                                <label for="blog_header" class="input-btn">ì‚¬ì§„ë³€ê²½</label>
                                                <input type="file" accept="image/*" id="blog_header" name="blog_header" onchange="readHeader(this)" style="display:none;">
                                                <label for="headerReset" class="input-btn">ì‚­ì œ</label>
                                                <input type="reset" id="headerReset" style="display:none;"/>
                                             </div>
                                             </div>                                                
                                          </td>
                                       </tr>
                                       <tr>
                                          <th>ì‚¬ì´ë“œë°”</th>
                                          <td><div class="color"><input type="color" id="blog_side" name="blog_sidebar" value="${myblog.blog_sidebar}"></div></td>
                                       </tr>
                                       <tr>
                                          <th>ë°°ê²½</th>
                                          <td><div class="color"><input type="color" id="blog_body" name="blog_main" value="${myblog.blog_main}"></div></td>
                                       </tr>
                                    </table>
                                       <div class="btnGroup">
                                          <input type="submit" value="ìˆ˜ì •">
                                          <input type="reset" value="ì·¨ì†Œ">
                                       </div>
                                   </form>
                                 </div>            
                           </div>
                        </div>

               </div>




      <!-- Scripts -->
         <script src="${cpath}/resources/js/jquery.min.js"></script>
         <!-- <script src="${cpath}/resources/js/jquery.scrollex.min.js"></script>
         <script src="${cpath}/resources/js/jquery.scrolly.min.js"></script> -->
         <script src="${cpath}/resources/js/browser.min.js"></script>
         <script src="${cpath}/resources/js/breakpoints.min.js"></script>
         <script src="${cpath}/resources/js/util.js"></script>
         <script src="${cpath}/resources/js/main.js"></script>
         <script src="${cpath}/resources/js/turn_js/turn.min.js"></script>
       <script src="${cpath}/resources/js/turn_js/turn.js"></script>
<script>
//ì´ë¯¸ì§€ ë°ê¸°ì— ë”°ë¼ í…ìŠ¤íŠ¸ ìƒ‰ìƒì„ ì¡°ì •í•˜ëŠ” í•¨ìˆ˜
function adjustTextColor(image, text) {
    var canvas = document.createElement('canvas');
    var context = canvas.getContext('2d');

    // ìº”ë²„ìŠ¤ í¬ê¸° ì„¤ì •
    canvas.width = image.naturalWidth;
    canvas.height = image.naturalHeight;

    // ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°
    context.drawImage(image, 0, 0);

    // í”½ì…€ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
    var imageData = context.getImageData(0, 0, canvas.width, canvas.height);
    var data = imageData.data;

    var r, g, b, avgBrightness;
    var totalBrightness = 0;
    var count = 0;

    // ê° í”½ì…€ì˜ ë°ê¸° ê³„ì‚°
    for (var i = 0; i < data.length; i += 4) {
        r = data[i];
        g = data[i + 1];
        b = data[i + 2];
        avgBrightness = (r + g + b) / 3;
        totalBrightness += avgBrightness;
        count++;
    }

    // ì´ë¯¸ì§€ì˜ í‰ê·  ë°ê¸° ê³„ì‚°
    var averageBrightness = totalBrightness / count;

    // í‰ê·  ë°ê¸°ì— ë”°ë¼ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ê²°ì •
    text.style.color = averageBrightness > 128 ? 'black' : 'white';
}

// í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ì‹¤í–‰
window.onload = function() {
    var image = document.getElementById('headerImage');
    var text = document.getElementById('imageText');

    // ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì¡°ì •
    image.onload = function() {
        adjustTextColor(image, text);
    };

    // ì´ë¯¸ì§€ ì†ŒìŠ¤ ë³€ê²½ ì‹œ í…ìŠ¤íŠ¸ ìƒ‰ìƒì„ ì¡°ì •í•˜ë ¤ë©´ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
    // ì˜ˆì‹œ: image.src = 'path_to_new_image.jpg';
};

// ì´ë¯¸ì§€ê°€ ë³€ê²½ë  ë•Œë§ˆë‹¤ í˜¸ì¶œë˜ì–´ì•¼ í•˜ëŠ” í•¨ìˆ˜
function changeImage(newSrc) {
    var image = document.getElementById('headerImage');
    var text = document.getElementById('imageText');

    // ì´ë¯¸ì§€ ì†ŒìŠ¤ ë³€ê²½
    image.src = newSrc;

    // ì´ë¯¸ì§€ ë¡œë“œ ì™„ë£Œ ì‹œ ë°ê¸°ì— ë”°ë¼ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì¡°ì •
    image.onload = function() {
        adjustTextColor(image, text);
    };
}


var book = $("#book");



document.addEventListener('DOMContentLoaded', function () {
    const sectionLinks = document.querySelectorAll('.section-link');
    const containers = document.querySelectorAll('.container');
   
    
    containers.forEach(container => {
        if (container.id === 'diary') {
            container.style.display = 'block';
        } else {
            container.style.display = 'none';
        }
    });
    // ì´ˆê¸°ì— diaryë§Œ ë³´ì´ê²Œ ì„¤ì •í•˜ê³ , ë‹¤ì´ì–´ë¦¬ ì´ˆê¸°í™”
    

    sectionLinks.forEach(link => {
        link.addEventListener('click', function (e) {
            e.preventDefault();
            const targetContainerId = link.getAttribute('data-section');

            // ëª¨ë“  containerë¥¼ ìˆ¨ê¹€
            containers.forEach(container => {
                container.style.display = 'none';
            });

            // í´ë¦­í•œ ë§í¬ì˜ data-section ê°’ì„ ê°€ì ¸ì™€ í•´ë‹¹ containerë¥¼ í‘œì‹œ
            const targetContainer = document.getElementById(targetContainerId);

            if (targetContainer) {
                targetContainer.style.display = 'block';
            
                if (targetContainerId === 'diary') {
                    location.reload();
                }
               
             
            }
        });
    });
});



function getBoard(idx) {
    console.log(idx);
    
    $.ajax({
        url: "${cpath}/board/getBoard",
        data: {"idx": idx},
        type: "get",
        dataType: "json",
        success: makeBoard,
        error: function(e) {
            console.log(e);
        }
    });
}


function makeBoard(data) {
   console.log(data);
    var listHtml = "";
    var boardTitleElement = $("#boardTitle");
    // ì²« í˜ì´ì§€ (í‘œì§€)ëŠ” ë¹„ì›Œë‘¡ë‹ˆë‹¤.
    listHtml += "<div class='hard' style='width: 820; height: 620;'></div>";
    // ë‘ ë²ˆì§¸ ë°ì´í„° í•­ëª©ë¶€í„° ì´ë¯¸ì§€ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
    $.each(data, function(index, obj) {
       $("#diaryName").text(obj.bd_diary);
         // í˜„ì¬ í˜ì´ì§€ì˜ ì œëª©ìœ¼ë¡œ #boardTitle ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ë™ì ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
  
        listHtml += "<div class='page' style='background-image: url(" + obj.bd_content + "); background-size: 200% 100%; background-position: left;'>";
        listHtml += "</div>"; // ì™¼ìª½ ë©´

        listHtml += "<div class='page' style='background-image: url(" + obj.bd_content + "); background-size: 200% 100%; background-position: right;'>";
        listHtml += "</div>"; // ì˜¤ë¥¸ìª½ ë©´
    });
    
    book.html(listHtml);

    // turn.jsë¥¼ ì‚¬ìš©í•˜ì—¬ ì±… ë„˜ê¸°ê¸° íš¨ê³¼ ì´ˆê¸°í™”
    book.turn({
    	display:"double",
    	page:2,
                   width: 800,
                   height: 600,
                   autoCenter: true,
                   gradients: true
               }).on("turning", function(event, page, view) {
                   // í˜ì´ì§€ê°€ ë„˜ì–´ê°ˆ ë•Œë§ˆë‹¤ ì œëª©, ë‹‰ë„¤ì„, ë‹¤ì´ì–´ë¦¬ ì´ë¦„ ì—…ë°ì´íŠ¸
                   if(page > 1){
                      var currentPageData = data[Math.floor(page/2)-1]; // í˜ì´ì§€ ì¸ë±ìŠ¤ë¥¼ ë°ì´í„° ì¸ë±ìŠ¤ë¡œ ë³€í™˜
                      console.log(data);
                      console.log(page, currentPageData);
                     
                      $('#boardTitle').text(currentPageData.bd_title);
                      $('#boardTitle').show();
                      $('#book').addClass("book-shadow");
                  } else {
                      $('#boardTitle').hide();
                  }
                  /* $(".page").addClass("page-flipping"); */
               
               });
    
    // í˜„ì¬ í˜ì´ì§€ ì—…ë°ì´íŠ¸
    //updateCurrentPage(book.turn('page'));

    // ì´ í˜ì´ì§€ ìˆ˜ ì—…ë°ì´íŠ¸
    //updateTotalPages(book.turn('pages'));
    
}

/* function updateCurrentPage(pageNumber) {
     document.getElementById('current-page').textContent = pageNumber;
   }

   function updateTotalPages(totalPages) {
     document.getElementById('total-pages').textContent = totalPages;
   }  */

   // í˜ì´ì§€ ë³€ê²½ í•¨ìˆ˜
   function changePage(direction) {
     // í˜„ì¬ í˜ì´ì§€ì™€ ì´ í˜ì´ì§€ ìˆ˜ë¥¼ ê°€ì ¸ì˜´
     var currentPage = book.turn('page');
     console.log("currentPage",currentPage);
     var totalPages = book.turn('pages');
     console.log("totalPages",totalPages);
     
     if (direction === 'prev' && currentPage > 3) {
          book.turn('previous');
     } else if (direction === 'next' && currentPage < totalPages) {
       book.turn('next');
     }

     // í˜ì´ì§€ ë³€ê²½ í›„ í˜„ì¬ í˜ì´ì§€ ì—…ë°ì´íŠ¸
     //updateCurrentPage(book.turn('page'));
   }

   // ì´ˆê¸° í˜ì´ì§€ ì„¤ì • (í˜ì´ì§€ ë¡œë”© ì‹œ ì‹¤í–‰)
   document.addEventListener('DOMContentLoaded', function() {
     // ì´ˆê¸° í˜ì´ì§• ì •ë³´ ì—…ë°ì´íŠ¸
     if (book.turn('pages')) { // 'book'ì´ ì´ë¯¸ ì´ˆê¸°í™”ë˜ì—ˆë‹¤ë©´
       //updateTotalPages(book.turn('pages'));
       //updateCurrentPage(book.turn('page'));
     }
   });


   $(window).resize(function() {
	    var width = $('#book').parent().width();
	    var height = width * 0.75; // ê°€ë¡œ ì„¸ë¡œ ë¹„ìœ¨ ìœ ì§€
	    $('#book').turn('size', width, height);
	});
    // ë¸”ë¡œê·¸ ê´€ë¦¬ - í”„ë¡œí•„ ì‚¬ì§„ ë¯¸ë¦¬ë³´ê¸°
    function readProfile(input) {
         if (input.files && input.files[0]) {
           var reader = new FileReader();
           reader.onload = function(e) {
             document.getElementById('profile').src = e.target.result;
           };
           reader.readAsDataURL(input.files[0]);
                   
         } else {
           document.getElementById('profile').src = "";
         }       
       }
    
       // ì‚­ì œ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€ë¥¼ ì§€ìš°ê³  íŒŒì¼ ì…ë ¥ í•„ë“œë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
         document.getElementById('profileReset').addEventListener('click', function() {
           document.getElementById('profile').src = "";
           document.getElementById('blog_profile').value = ""; // íŒŒì¼ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
         });         
    
    
       
       
    function readHeader(input) {
         if (input.files && input.files[0]) {
           var reader = new FileReader();
           reader.onload = function(e) {
             document.getElementById('blogHeader').src = e.target.result;
           };
           reader.readAsDataURL(input.files[0]);
         } else {
           document.getElementById('blogHeader').src = "";
         }
       }
    
       // ì‚­ì œ ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ë¯¸ë¦¬ë³´ê¸° í—¤ë” ì´ë¯¸ì§€ë¥¼ ì§€ìš°ê³  íŒŒì¼ ì…ë ¥ í•„ë“œë¥¼ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
         document.getElementById('headerReset').addEventListener('click', function() {
           document.getElementById('blogHeader').src = "";
           document.getElementById('blog_header').value = ""; // íŒŒì¼ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
         });         

    // ë°©ëª…ë¡ ë„ìš°ê¸°
    $(document).ready(function(){
      // í˜ì´ì§€ê°€ ì—´ë¦´ ë•Œ ë°”ë¡œ ì‹¤í–‰ë˜ê²Œ ë§Œë“¤ì–´ì£¼ê¸°
      // HTMLì´ ë‹¤ ë¡œë”©ë˜ê³ ë‚˜ì„œ ì•„ë˜ ì½”ë“œ ì‹¤í–‰í•´ë¼
      loadList();
      
   });
   
   
   function loadList(){
      // ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ê²Œì‹œê¸€ ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
      // ajax : ìš”ì²­URL, ì–´ë–»ê²Œ ë°ì´í„° ë°›ì„ì§€, ìš”ì²­ë°©ì‹ ë“± ... -> ê°ì²´í˜•íƒœë¡œ : {}(JSON í˜•ì‹)
      // success ì‹œ í•¨ìˆ˜(makeView)ë¥¼ ì‹¤í–‰ : ajaxë¡œ ìš”ì²­í•˜ê³  ë‚˜ì„œ ê²°ê³¼ë¥¼ ë°›ì•„ì™€ì„œ ëë‚˜ê³ (ëŒì•„ì™€ì„œ) ì‹¤í–‰í•˜ëŠ” í•¨ìˆ˜ -> ì½œë°±í•¨ìˆ˜
      var id = "${mvo.user_id}";
      
      //console.log(id);
      $.ajax({
         url :"${cpath}/myblog/getVisit",
         data : {"id":id},
         type :"get",
         dataType :"json",
         success : makeView,  // ì½œë°±í•¨ìˆ˜
         error : function(e){
            console.log(e);
         }
      });
   }
   
   function makeView(data){
      var   listHtml = "";
      
      $.each(data, function(index, obj){
         listHtml += "<div class='Card img-fluid post' style='width:300px'>";
         listHtml += "<img class='card-img-top imgCard' src='${awsPath}/img/postit.png' alt='Card image' style='width:100%'>";
         listHtml += "<div class='card-img-overlay'>";
          listHtml += "<h4 class='card-title title'>" +obj.user_nick + "</h4>";
          listHtml += "<p class='card-text'>" + obj.gb_content + "</p>";
          listHtml += "<br>";
          listHtml += "<p class='indate'>"+obj.created_at + "</p>";
          listHtml += "<a href='${cpath}/blog/"+obj.guest+"' class='btn btn-sm btn-defalut' style='border:solid 0.5px #dfdfdf;'>êµ¬ê²½ê°€ê¸°</a>";
          listHtml += "</div></div>";
         
      });
      
      
      

      $("#visitList").html(listHtml);
      
   }
   


   

</script>
<!-- ì‚¬ìš©ì ì§€ì •ìƒ‰ì— ë”°ë¥¸ ë¸”ë¡œê·¸ í°íŠ¸ ìƒ‰ìƒ ë³€ê²½ -->         
<script type="text/javascript">
/* ë°°ê²½ */
document.addEventListener('DOMContentLoaded', function() {
    var bgColor = "${myblog.blog_main}";
    var color = hexToRgb(bgColor);
    var brightness = (color.r * 299 + color.g * 587 + color.b * 114) / 1000;
    var textColor = brightness < 128 ? 'white' : 'rgb(49 49 49)';
    
    // ëª¨ë“  .title ìš”ì†Œë¥¼ ì„ íƒí•˜ê³  ìŠ¤íƒ€ì¼ ì ìš©
    document.querySelectorAll('#diaryContainer .area_text .title').forEach(function(element) {
        element.style.color = textColor;
    });
    
    document.querySelectorAll('#diary h3, #guestBook h3, #guestBook h6, #diary h6, #blogSetting h3').forEach(function(element) {
        element.style.color = textColor;
    });
    

    // í˜ì´ì§€ ë²„íŠ¼ ë³€ê²½
    var prevImg = document.getElementById('prev-btn');
    var nextImg = document.getElementById('next-btn');
    if(brightness < 128) {
       prevImg = "../../resources/img/left-white.png";
       nextImg = "${cpath}/resources/img/right-white.png";
    }else{
       prevImg = "${cpath}/resources/img/left-dark.png";
       nextImg = "${cpath}/resources/img/right-dark.png";
    }
    
    
});

/* ì‚¬ì´ë“œë°” */
document.addEventListener('DOMContentLoaded', function() {
    var bgColor = "${myblog.blog_sidebar}";
    var color = hexToRgb(bgColor);
    var brightness = (color.r * 299 + color.g * 587 + color.b * 114) / 1000;
    var textColor = brightness < 220 ? 'white' : 'rgb(95, 95, 95)';

    var navItems = document.querySelectorAll('#header > nav ul li');
    
    if (bgColor === '#ffffff') {
        var activeLinks = document.querySelectorAll('#header > nav ul li a.active');

        activeLinks.forEach(function(link) {
            link.style.backgroundColor = 'rgb(95, 95, 95)';
        });
    }

    document.querySelectorAll('#header h1 a, #header > header p, #header > nav ul li a:not(.active), #header > footer .icons li').forEach(function(element) {
        element.style.color = textColor;
        
    });
    
    // ëª¨ë“  nav í•­ëª©ì— ëŒ€í•œ í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
    navItems.forEach(function(item) {
        item.addEventListener('click', function() {
            // ëª¨ë“  ë§í¬ë¥¼ ê¸°ë³¸ ìƒ‰ìƒìœ¼ë¡œ ì¬ì„¤ì •
            navItems.forEach(function(otherItem) {
                var otherLink = otherItem.querySelector('a');
                
                if (bgColor){
                  otherLink.style.backgroundColor = bgColor;                   
                    otherLink.style.color = textColor;
                    otherLink.style.fontWeight = 'normal';
                }

            });

            // í˜„ì¬ í´ë¦­ëœ í•­ëª©ì˜ ë§í¬ ìƒ‰ìƒì„ ë³€ê²½
            var link = item.querySelector('a');
            if (link) {
                link.style.color = bgColor;
                link.style.fontWeight = 'bold';
                
               if (bgColor === '#ffffff'){
                   // ì‚¬ì´ë“œë°” ìƒ‰ìƒ whiteì¼ ê²½ìš°
                  link.style.backgroundColor = 'rgb(95, 95, 95)';
               }else{
                   link.style.backgroundColor = 'white';
                  
               }
            }
        });
    });
    
});



function hexToRgb(hex) {
    var bigint = parseInt(hex.slice(1), 16);
    var r = (bigint >> 16) & 255;
    var g = (bigint >> 8) & 255;
    var b = bigint & 255;

    return { r, g, b };
}



</script>

   </body>
</html>